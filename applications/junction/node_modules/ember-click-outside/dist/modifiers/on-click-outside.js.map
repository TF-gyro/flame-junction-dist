{"version":3,"file":"on-click-outside.js","sources":["../../src/-private/matches-selector.js","../../src/utils.js","../../src/modifiers/on-click-outside.js"],"sourcesContent":["// https://github.com/zeppelin/ember-click-outside/issues/23\n\nconst proto = typeof Element !== 'undefined' ? Element.prototype : {};\nconst vendor =\n  proto.matches ||\n  proto.matchesSelector ||\n  proto.webkitMatchesSelector ||\n  proto.mozMatchesSelector ||\n  proto.msMatchesSelector ||\n  proto.oMatchesSelector;\n\nexport function matches(el, selector) {\n  if (!el || el.nodeType !== 1) return false;\n  if (vendor) return vendor.call(el, selector);\n  var nodes = el.parentNode.querySelectorAll(selector);\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i] == el) return true;\n  }\n  return false;\n}\n","import { matches } from './-private/matches-selector';\n\nexport function closest(element, selector) {\n  if (matches(element, selector)) {\n    return element;\n  }\n\n  while (element.parentNode) {\n    element = element.parentNode;\n\n    if (matches(element, selector)) {\n      return element;\n    }\n  }\n}\n\nexport const documentOrBodyContains = (element) => {\n  // https://github.com/zeppelin/ember-click-outside/issues/30\n  if (typeof document.contains === 'function') {\n    return document.contains(element);\n  } else {\n    return document.body.contains(element);\n  }\n};\n\nexport const ios = () => {\n  return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n};\n","import { next, cancel } from '@ember/runloop';\nimport { registerDestructor } from '@ember/destroyable';\nimport Modifier from 'ember-modifier';\n\nimport { closest, documentOrBodyContains, ios } from '../utils';\n\nexport default class ClickOutsideModifier extends Modifier {\n  didSetup = false;\n  action = null;\n  capture = null;\n  eventHandler = null;\n  eventType = 'click';\n  exceptSelector = null;\n\n  cancelOutsideListenerSetup = null;\n\n  constructor() {\n    super(...arguments);\n    registerDestructor(this, this.cleanup);\n  }\n\n  modify(element, [action], { capture, eventType, exceptSelector }) {\n    if (!this.didSetup) {\n      if (ios()) {\n        document.body.style.cursor = 'pointer';\n      }\n\n      this.didSetup = true;\n    } else {\n      this._destroy();\n    }\n    this._init({\n      element,\n      action,\n      capture,\n      eventType,\n      exceptSelector,\n    });\n  }\n\n  cleanup = () => {\n    this._destroy();\n\n    if (ios()) {\n      document.body.style.cursor = '';\n    }\n  };\n\n  _init({ element, action, capture, eventType, exceptSelector }) {\n    if (!action) {\n      return;\n    }\n\n    this.action = action;\n    this.exceptSelector = exceptSelector;\n    this.capture = capture;\n\n    if (eventType) {\n      this.eventType = eventType;\n    }\n\n    this.eventHandler = this._createHandler(\n      element,\n      this.action,\n      this.exceptSelector\n    );\n    this.cancelOutsideListenerSetup = next(this, this._addClickOutsideListener);\n  }\n\n  _destroy() {\n    if (!this.action) {\n      return;\n    }\n\n    cancel(this.cancelOutsideListenerSetup);\n    this._removeClickOutsideListener();\n  }\n\n  _addClickOutsideListener() {\n    let { capture, eventHandler, eventType } = this;\n    document.addEventListener(eventType, eventHandler, { capture });\n  }\n\n  _removeClickOutsideListener() {\n    let { capture, eventHandler, eventType } = this;\n    document.removeEventListener(eventType, eventHandler, { capture });\n  }\n\n  _createHandler(element, action, exceptSelector) {\n    return (e) => {\n      if (exceptSelector && e.target && closest(e.target, exceptSelector)) {\n        return;\n      }\n\n      let path = e.path || (e.composedPath && e.composedPath());\n\n      if (path) {\n        path.includes(element) || action(e);\n      } else {\n        // Check if the click target still is in the DOM.\n        // If not, there is no way to know if it was inside the element or not.\n        let isRemoved = !e.target || !documentOrBodyContains(e.target);\n\n        // Check the element is found as a parent of the click target.\n        let isInside = element === e.target || element.contains(e.target);\n\n        if (!isRemoved && !isInside) {\n          action(e);\n        }\n      }\n    };\n  }\n}\n"],"names":["proto","Element","prototype","vendor","matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","el","selector","nodeType","call","nodes","parentNode","querySelectorAll","i","length","closest","element","documentOrBodyContains","document","contains","body","ios","test","navigator","userAgent","window","MSStream","ClickOutsideModifier","Modifier","constructor","arguments","_destroy","style","cursor","registerDestructor","cleanup","modify","action","capture","eventType","exceptSelector","didSetup","_init","eventHandler","_createHandler","cancelOutsideListenerSetup","next","_addClickOutsideListener","cancel","_removeClickOutsideListener","addEventListener","removeEventListener","e","target","path","composedPath","includes","isRemoved","isInside"],"mappings":"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"}